@model CloudBasedRMS.View.Controllers.ViewModel.DashboardViewModel
@using CloudBasedRMS.View.Controllers.Helper
@{
    ViewBag.Title = "Dashboard";
    Layout = "~/Views/Shared/_LayoutNew.cshtml";
}
<div class="breadcrumbs ace-save-state" id="breadcrumbs">
    <ul class="breadcrumb">
        <li>
            <i class="ace-icon fa fa-home home-icon"></i>
            <a href="#">@Resource.Home</a>
        </li>
        <li class="active">@Resource.Dashboard</li>
    </ul><!-- /.breadcrumb -->
</div>

<div class="page-content" ng-controller="BillFoodItemsController">
    @*<div id="divLoading" style="margin: 0px; padding: 0px; position: fixed; right: 0px;
                top: 0px; width: 100%; height: 100%; background-color: #666666; z-index: 30001;
                opacity: .8; filter: alpha(opacity=70);display:none">
            <p style="position: absolute; top: 20%; left:30%; color: White;">
                <img src="~/Images/LoadingImages/giphy.gif">
            </p>
        </div>*@
    <div class="row">
        <div class="col-xs-12">
            <!-- PAGE CONTENT BEGINS -->
            <div class="alert alert-block alert-success wow shake" data-wow-iteration="infinite">
                <button type="button" class="close" data-dismiss="alert">
                    <i class="ace-icon fa fa-times"></i>
                </button>
                <i class="ace-icon fa fa-check green"></i>
                @Resource.Welcome
                <strong class="green">
                    CloudBased Restaurant Management System
                </strong>,
                @Resource.HaveaniceDay
            </div>
            <div class="row">
                <div class="space-6"></div>
                <div class="col-sm-6 infobox-container wow bounceInDown">
                    <div class="infobox infobox-green">
                        <div class="infobox-icon">
                            <i class="ace-icon fa fa-comments"></i>
                        </div>
                        <div class="infobox-data">
                            <span class="infobox-data-number">@ViewBag.TotalOrderedtableCount </span>
                            <div class="infobox-content">Total ordering tables</div>
                        </div>

                        <div class="stat stat-success">8%</div>
                    </div>
                    <div class="infobox infobox-blue">
                        <div class="infobox-icon">
                            <i class="ace-icon fa fa-users"></i>
                        </div>

                        <div class="infobox-data">
                            <span class="infobox-data-number">@ViewBag.CustomerCount</span>
                            <div class="infobox-content">@Resource.NewCustomers</div>
                        </div>

                        <div class="badge badge-success">
                            +32%
                            <i class="ace-icon fa fa-arrow-up"></i>
                        </div>
                    </div>
                    <div class="infobox infobox-pink">
                        <div class="infobox-icon">
                            <i class="ace-icon fa fa-shopping-cart"></i>
                        </div>

                        <div class="infobox-data">
                            <span class="infobox-data-number">@ViewBag.orderCount,@ViewBag.orderConfirm</span>
                            <div class="infobox-content">@Resource.NewOrder,@Resource.ConfirmOrder</div>
                        </div>
                        <div class="stat stat-important">4%</div>
                    </div>
                    <div class="infobox infobox-green">
                        <div class="infobox-icon">
                            <i class="ace-icon fa fa-users"></i>
                        </div>

                        <div class="infobox-data">
                            <span class="infobox-data-number">@ViewBag.EmployeeCount</span>
                            <div class="infobox-chart">@Resource.NewEmployee</div>
                        </div>
                    </div>
                    <div class="infobox infobox-orange2">
                        <div class="infobox-chart">
                            <span class="sparkline" data-values="196,128,202,177,154,94,100,170,224"></span>
                        </div>

                        <div class="infobox-data">
                            <span class="infobox-data-number">6,251</span>
                            <div class="infobox-content">pageviews</div>
                        </div>

                        <div class="badge badge-success">
                            7.2%
                            <i class="ace-icon fa fa-arrow-up"></i>
                        </div>
                    </div>
                    <div class="infobox infobox-blue2">
                        <div class="infobox-progress">
                            <div class="easy-pie-chart percentage" data-percent="42" data-size="46">
                                <span class="percent">42</span>%
                            </div>
                        </div>

                        <div class="infobox-data">
                            <span class="infobox-text">traffic used</span>

                            <div class="infobox-content">
                                <span class="bigger-110">~</span>
                                58GB remaining
                            </div>
                        </div>
                    </div>
                    <div class="space-6"></div>
                    <div class="infobox infobox-green infobox-small infobox-dark">
                        <div class="infobox-progress">
                            <div class="easy-pie-chart percentage" data-percent="61" data-size="39">
                                <span class="percent">61</span>%
                            </div>
                        </div>

                        <div class="infobox-data">
                            <div class="infobox-content">Task</div>
                            <div class="infobox-content">Completion</div>
                        </div>
                    </div>
                    <div class="infobox infobox-blue infobox-small infobox-dark">
                        <div class="infobox-chart">
                            <span class="sparkline" data-values="3,4,2,3,4,4,2,2"></span>
                        </div>

                        <div class="infobox-data">
                            <div class="infobox-content">Earnings</div>
                            <div class="infobox-content">$32,000</div>
                        </div>
                    </div>
                    <div class="infobox infobox-grey infobox-small infobox-dark">
                        <div class="infobox-icon">
                            <i class="ace-icon fa fa-download"></i>
                        </div>

                        <div class="infobox-data">
                            <div class="infobox-content">Downloads</div>
                            <div class="infobox-content">1,205</div>
                        </div>
                    </div>
                </div>
                <div class="vspace-12-sm"></div>
                <div class="col-sm-5">
                    <div class="wow lightSpeedIn" data-wow-duration="5s" >
                        <div class="widget-header widget-header-flat widget-header-small">
                            <h5 class="widget-title">
                                <i class="ace-icon fa fa-signal"></i>
                                @Resource.EmployeeStrength
                            </h5>
                            <div class="widget-body">
                                <div class="widget-main">
                                    <div id="EmployeeStrengthContainer" style="height: 250px; width: 100%;"></div>
                                    @*<div style="text-align: center;width:300px">
                                            <canvas id="Piecanvas"></canvas>
                                        </div>*@
                                </div><!-- /.widget-main -->
                            </div>
                        </div>
                        <!-- /.widget-body -->
                    </div><!-- /Employee Strength.widget-box -->
                </div><!-- /.col -->
            </div><!-- /.row -->
            <div class="hr hr32 hr-dotted"></div>
            <div class="row">
                <div class="col-sm-5">
                    <div class="wow bounceInLeft" data-wow-offset="200">
                        <div class="widget-header widget-header-flat">
                            <h4 class="widget-title lighter">
                                <i class="ace-icon fa fa-star orange"></i>
                                @Resource.PopularOrderingFoodItems
                            </h4>

                            <div class="widget-toolbar">
                                <a href="#" data-action="collapse">
                                    <i class="ace-icon fa fa-chevron-up"></i>
                                </a>
                            </div>
                        </div>

                        <div class="widget-body">
                            <div class="widget-main no-padding">
                                <table class="table table-bordered table-striped">
                                    <thead class="thin-border-bottom">
                                        <tr>
                                            <th>
                                                <i class="ace-icon fa fa-caret-right blue"></i>@Resource.FoodName
                                            </th>

                                            <th>
                                                <i class="ace-icon fa fa-caret-right blue"></i>@Resource.Price
                                            </th>

                                            <th class="hidden-480">
                                                <i class="ace-icon fa fa-caret-right blue"></i>@Resource.IsTodaySpecial
                                            </th>
                                        </tr>
                                    </thead>

                                    <tbody>
                                        @if (Model.BillFoods != null)
                                        {
                                            foreach (var item in Model.BillFoods)
                                            {
                                                <tr>
                                                    <td>@item.FoodITemsDetails.Description</td>
                                                    <td>
                                                        <small>
                                                            <s class="red">@item.FoodITemsDetails.OldPrice</s>
                                                        </small>
                                                        <b class="green">@item.FoodITemsDetails.NewPrice</b>
                                                    </td>
                                                    <td class="hidden-480">
                                                        <span class="label label-info arrowed-in-right arrowed-in-right">
                                                            @if (item.FoodITemsDetails.IsTodaySpecial == true)
                                                            { <b>YES</b> }
                                                            else
                                                            { <b>NO</b>}
                                                        </span>
                                                    </td>
                                                </tr>
                                            }
                                        }
                                    </tbody>
                                </table>
                            </div><!-- /.widget-main -->
                        </div><!-- /.widget-body -->
                    </div><!-- /.widget-box -->
                </div><!-- /PopularOrderingFoodItems.col -->

                <div class="col-sm-7">
                    <div class="wow slideInRight" data-wow-delay="2s" data-wow-offset="10">
                        <div class="widget-header widget-header-flat">
                            <h4 class="widget-title lighter">
                                <i class="ace-icon fa fa-signal"></i>
                                @Resource.SaleBillingStages
                            </h4>
                            <div class="widget-toolbar">
                                <a href="#" data-action="collapse">
                                    <i class="ace-icon fa fa-chevron-up"></i>
                                </a>
                            </div>
                            <div class="widget-toolbar no-border">
                                <div class="inline dropdown-hover">
                                    <button class="btn btn-minier btn-primary">
                                        This Week
                                        <i class="ace-icon fa fa-angle-down icon-on-right bigger-110"></i>
                                    </button>
                                    <ul class="dropdown-menu dropdown-menu-right dropdown-125 dropdown-lighter dropdown-close dropdown-caret">
                                        <li class="active">
                                            <a href="#" class="blue">
                                                <i class="ace-icon fa fa-caret-right bigger-110">&nbsp;</i>
                                                This Week
                                            </a>
                                        </li>

                                        <li>
                                            <a href="#">
                                                <i class="ace-icon fa fa-caret-right bigger-110 invisible">&nbsp;</i>
                                                Last Week
                                            </a>
                                        </li>

                                        <li>
                                            <a href="#">
                                                <i class="ace-icon fa fa-caret-right bigger-110 invisible">&nbsp;</i>
                                                This Month
                                            </a>
                                        </li>

                                        <li>
                                            <a href="#">
                                                <i class="ace-icon fa fa-caret-right bigger-110 invisible">&nbsp;</i>
                                                Last Month
                                            </a>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                        <div class="widget-body">
                            <div class="widget-main padding-4">
                                <div id="chart_container" class="form-horizontal">
                                    <canvas id="bar_chart_SaleBill"></canvas>
                                </div>
                                @*@Html.Chart("sampleChart", Model.TwoDimensionalData.Data, "Year", "Net Amount in Kyats");*@
                            </div><!-- /.widget-main -->
                        </div>
                        <!-- /.widget-body -->
                    </div><!-- /.widget-box -->
                </div><!-- /SaleBillingStages .col -->
            </div><!-- /.row -->
            <div class="hr hr32 hr-dotted"></div>
            <div class="row">
                <div class="col-sm-6">
                    <div class="wow flipInX" id="recent-box" data-wow-duration="5000ms" data-wow-iteration="20s">
                        <div class="widget-header">
                            <h4 class="widget-title lighter smaller">
                                <i class="ace-icon fa fa-rss orange">
                                </i>@Resource.RECENTTRANSACTION
                            </h4>
                            <div class="widget-toolbar no-border">
                                <ul class="nav nav-tabs" id="recent-tab">
                                    <li class="active">
                                        <a data-toggle="tab" href="#task-tab">@Resource.AvailableTables</a>
                                    </li>
                                    <li>
                                        <a data-toggle="tab" href="#member-tab">@Resource.OrderingTable</a>
                                    </li>
                                    <li>
                                        <a data-toggle="tab" href="#comment-tab">@Resource.PopularFoodNameTotalPricce</a>
                                    </li>
                                </ul>
                            </div>
                        </div>

                        <div class="widget-body">
                            <div class="widget-main padding-4">
                                <div class="tab-content padding-8">
                                    <div id="task-tab" class="tab-pane active">
                                        <h4 class="smaller lighter green">
                                            <i class="ace-icon fa fa-list"></i>
                                            table no and its capacity
                                        </h4>
                                        <ul id="tasks" class="item-list">
                                            @foreach (var table in Model.tablelist)
                                            {
                                                @*
                                                    <li class="item-orange clearfix">
                                                        <label class="inline">
                                                            <input type="checkbox" class="ace" />
                                                            <span class="lbl"> @table.TableNo</span>
                                                        </label>

                                                        <div class="pull-right easy-pie-chart percentage" data-size="30" data-color="#ECCB71" data-percent="42">
                                                            <span class="percent">@table.Capacity</span>%
                                                        </div>
                                                    </li>*@
                                                <li class="item-pink clearfix">
                                                    <label class="inline">
                                                        <input type="checkbox" class="ace" />
                                                        <span class="lbl">@table.TableNo is available</span>
                                                    </label>
                                                    <label class="inline">
                                                        <span class="lbl">and @table.Capacity persons can sit.</span>
                                                    </label>
                                                </li>
                                            }
                                        </ul>
                                    </div><!-- /.#Ordering-tab -->
                                    <div id="member-tab" class="tab-pane">
                                        @if (Model.OrderMaster != null)
                                        {
                                            <div class="clearfix">
                                                @foreach (var o in Model.OrderMaster)
                                                {
                                                    <div class="itemdiv memberdiv">
                                                        <div class="user">
                                                            <img src="@Url.Content(o.Table.Employee.ImagePath)" width="50" height="50" alt="@o.Table.Employee.Name" />
                                                        </div>
                                                        <div class="body">
                                                            <div class="name">
                                                                <a href="#">@o.Table.TableNo</a>
                                                            </div>

                                                            <div class="time">
                                                                <i class="ace-icon fa fa-clock-o"></i>
                                                                <span class="green">@o.Table.CreatedDate.ToShortTimeString()</span>
                                                            </div>
                                                            <div class="clear">
                                                                <i class="ace-icon fa fa-users">
                                                                    <span class="blue">@o.Table.Capacity</span>
                                                                </i>
                                                            </div>
                                                            <div>
                                                                <span class="label label-warning label-sm">ordering</span>
                                                                <div class="inline position-relative">
                                                                    <button class="btn btn-minier btn-yellow btn-no-border dropdown-toggle" data-toggle="dropdown" data-position="auto">
                                                                        <i class="ace-icon fa fa-angle-down icon-only bigger-120"></i>
                                                                    </button>

                                                                    <ul class="dropdown-menu dropdown-only-icon dropdown-yellow dropdown-menu-right dropdown-caret dropdown-close">
                                                                        <li>
                                                                            <a href="@Url.Action("ConfirmOrder", "Dashboard" , new { id=o.OrderMasterID})" class="tooltip-success" data-rel="tooltip" title="Confirm Order">
                                                                                <span class="green">
                                                                                    <i class="ace-icon fa fa-check bigger-110"></i>
                                                                                </span>
                                                                            </a>
                                                                        </li>

                                                                        <li>
                                                                            <a href="@Url.Action("CancelOrder", "Dashboard" , new { id=o.OrderMasterID})" class="tooltip-warning" data-rel="tooltip" title="Cancel Order">
                                                                                <span class="orange">
                                                                                    <i class="ace-icon fa fa-times bigger-110"></i>
                                                                                </span>
                                                                            </a>
                                                                        </li>

                                                                        <li>
                                                                            <a href="@Url.Action("DeleteOrder", "Dashboard" , new { id=o.OrderMasterID})" class="tooltip-error" data-rel="tooltip" title="Delete Order">
                                                                                <span class="red">
                                                                                    <i class="ace-icon fa fa-trash-o bigger-110"></i>
                                                                                </span>
                                                                            </a>
                                                                        </li>
                                                                    </ul>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                }
                                            </div>
                                        }
                                        <div class="space-4"></div>
                                        <div class="center">
                                            <i class="ace-icon fa fa-users fa-2x green middle"></i>
                                            &nbsp;
                                            <a href="#" class="btn btn-sm btn-white btn-info">
                                                See all ordered tables &nbsp;
                                                <i class="ace-icon fa fa-arrow-right"></i>
                                            </a>
                                        </div>
                                        <div class="hr hr-double hr8"></div>
                                    </div><!-- /.#member-tab -->
                                    <div id="comment-tab" class="tab-pane">
                                        <div class="comments">
                                            <div id="BillFoodItemsDataPointschartContainer" style="height: 200px; width:auto;"></div>
                                        </div>
                                    </div><!-- /.#Comment-tab -->
                                </div>
                            </div><!-- /.widget-main -->
                        </div><!-- /.widget-body -->
                    </div><!-- /.widget-box -->
                </div><!--RECENTTRANSACTION /.col -->

                <div class="col-sm-6">
                    <div class="wow pulse" data-wow-iteration="20s" data-wow-duration="2000ms">
                        <div class="widget-header">
                            <h4 class="widget-title lighter smaller">
                                <i class="ace-icon fa fa-comment blue"></i>
                                KOT Conversation
                            </h4>
                        </div>

                        <div class="widget-body">
                            @if (Model.KOTPickUp != null)
                            {
                                <div class="widget-main no-padding">
                                    <div class="dialogs">
                                        @foreach (var kotitem in Model.KOTPickUp)
                                        {<div class="itemdiv dialogdiv">

                                            <div class="user">
                                                <img alt="Alexa's Avatar" src="~/assets/images/avatars/avatar1.png" />
                                            </div>

                                            <div class="body">
                                                <div class="time">
                                                    <i class="ace-icon fa fa-clock-o"></i>
                                                    <span class="green">@kotitem.orderItems.CreatedDate.Minute Sec</span>
                                                </div>

                                                <div class="name">
                                                    <a href="#">Alexa</a>
                                                </div>
                                                <div class="text">hi,@kotitem.OrderMaster.Table.TableNo User your food order ready to&nbsp; pick up right now.<br></div>

                                                <div class="tools">
                                                    <a href="#" class="btn btn-minier btn-info">
                                                        <i class="icon-only ace-icon fa fa-share"></i>
                                                    </a>
                                                </div>
                                            </div>
                                        </div>
                                        }
                                    </div>
                                    <form>
                                        <div class="form-actions">
                                            <div class="input-group">
                                                <input placeholder="Type your message here ..." type="text" class="form-control" name="message" />
                                                <span class="input-group-btn">
                                                    <button class="btn btn-sm btn-info no-radius" type="button">
                                                        <i class="ace-icon fa fa-share"></i>
                                                        Send
                                                    </button>
                                                </span>
                                            </div>
                                        </div>
                                    </form>
                                </div><!-- /.widget-main -->
                            }
                        </div><!-- /.widget-body -->
                    </div><!-- /.widget-box -->
                </div><!-- KOT Conversation/.col -->
            </div><!-- /.row -->
            <!-- PAGE CONTENT ENDS -->
        </div><!-- /.col -->
    </div><!-- /.row -->
</div>

<style>
    #chart_container {
        width: auto;
        height: 350px;
        border: 1px solid #1930b1;
        padding: 1px;
        border-radius: 4px;
    }
     .wow:first-child {
            visibility: hidden;
        }
</style>

@section Scripts
{
    @Scripts.Render("~/Scripts/Chart.bundle.js")
    <link href="~/Scripts/material-charts/css/material-charts.css" rel="stylesheet" />
    <script src="~/Scripts/material-charts/js/material-charts.js"></script>
    <script src="~/Scripts/canvasjs/canvasjs.min.js"></script>
    <script src="~/Scripts/Chart.min.js"></script>
<script type="text/javascript">
        window.onload = function () {
            var chart = new CanvasJS.Chart("BillFoodItemsDataPointschartContainer", {
                data: [
                {
                    // Change type to "doughnut", "line", "splineArea","pie","column" etc.
                    showInLegend: true,
                    toolTipContent: "{y}Kyats",
                    yValueFormatString: "#0",
                    legendText: "{Label}",
                    type: "column",
                    dataPoints: @Html.Raw(ViewBag.BillFoodItemsDataPoints),
                }
                ]
            });
            chart.render();

            var EmployeeStrength = new CanvasJS.Chart("EmployeeStrengthContainer", {
                data: [
                {
                    showInLegend: true,
                    toolTipContent: "{y}-Count(s)",
                    yValueFormatString: "#0",
                    legendText: "{Label}",
                    // Change type to "doughnut", "line", "splineArea","pie","column" etc.
                    type: "pie",
                    dataPoints: @Html.Raw(ViewBag.EmployeeRecordPoints),
                }
                ]
            });
            EmployeeStrength.render();
        }
    </script>
    @*
        <script type="text/javascript">
                        $(function () {
                            barChart();
                            LoadingProgressBar();
                        });
                        function LoadingProgressBar() {
                            var url = '@Url.Action("Index", "Dashboard")';
                            $("#divLoading").hide();
                            $.get(url, null,
                                    function (data) {
                                        $("#PID")[0].innerHTML = data;
                                        $("#divLoading").hide();
                                    });
                        }
        </script>*@

    <script>
        //bar chart for sale bill by month
        var saledataarray=@Html.Raw(Json.Encode(ViewBag.saledata));
        var saleorderdate=@Html.Raw(Json.Encode(ViewBag.orderDate));
        var salebillctx=$("#bar_chart_SaleBill");
        var barchart=new Chart(salebillctx,{
            type:'bar',
            data:{
                labels:saleorderdate,
                datasets:[
                    {
                        label:"Sale Bill NetAmount in Kyat(s)",
                        data:saledataarray,
                        backgroundColor:["rgba(242,166,54,.5)","rgba(145,65,72,.5)","rgba(74,25,92,.5)"],
                        borderColor:["rgb(242,166,54)","rgb(145,65,72)","rgb(74,25,92,.5)"],
                        borderwidth:1
                    }
                ]
            },
            options:{
                maintainAspectRatio:false,
                scales:{xAxes:[{ticks:{beginAtZero:true}}]},
                legend:{display:true}
            }
        });
    </script>

    @*
        <script>
                                var PieChartData =
                                    {
                                        labels: [@Html.Raw(Json.Encode(ViewBag.RankName))],
                                        datasets: [
                                            {
                                            label: 'Employee Strength',
                                            backgroundColor: [
                                                "#f880a7",
                                                "#bbd2ed",
                                                "#996600",
                                                "#99e5e5",
                                                "#f7bdf3",
                                            ],
                                            borderWidth:1,
                                            data: [@Html.Raw(Json.Encode(ViewBag.RankCount))]
                                        }]
                                    };

                                window.onload = function () {
                                    var ctx1 = document.getElementById("Piecanvas").getContext("2d");
                                    window.myBar = new Chart(ctx1,
                                        {
                                            type: 'pie',
                                            data: PieChartData,
                                            options:
                                                {
                                                    title:
                                                    {
                                                        display: true
                                                    },
                                                    responsive: true,
                                                    maintainAspectRatio: true
                                                }
                                        });
                                }
        </script>*@
}

